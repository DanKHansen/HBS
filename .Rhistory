source('~/HBS/Exploratory.R', encoding = 'UTF-8')
setwd("~/HBS")
source('~/HBS/Exploratory.R', encoding = 'UTF-8')
ds1 <- read.csv("IT0808.txt", header = TRUE, sep = "\t", stringsAsFactors = FALSE, fileEncoding = "Latin1", na.strings = c('', ' '))
ds4 <- read.csv("IT1314.txt", header = TRUE, sep = "\t", stringsAsFactors = FALSE, fileEncoding = "Latin1", na.strings = c('', ' '))
ds1 <- read.csv("IT0808.txt", header = TRUE, sep = "\t", stringsAsFactors = FALSE, fileEncoding = "Latin1", na.strings = c('', ' '))
ds2 <- read.csv("IT0910.txt", header = TRUE, sep = "\t", stringsAsFactors = FALSE, fileEncoding = "Latin1", na.strings = c('', ' '))
ds4 <- read.csv("IT1314.txt", header = TRUE, sep = "\t", stringsAsFactors = FALSE, fileEncoding = "Latin1", na.strings = c('', ' '))
ds3 <- read.csv("IT1112.txt", header = TRUE, sep = "\t", stringsAsFactors = FALSE, fileEncoding = "Latin1", na.strings = c('', ' '))
View(ds3)
ds1 <- read.csv("IT0808.txt", header = TRUE, sep = "\t", stringsAsFactors = FALSE, na.strings = c('', ' '))
ds2 <- read.csv("IT0910.txt", header = TRUE, sep = "\t", stringsAsFactors = FALSE, na.strings = c('', ' '))
ds4 <- read.csv("IT1314.txt", header = TRUE, sep = "\t", stringsAsFactors = FALSE, na.strings = c('', ' '))
IT1112 <- read.delim("~/GitHub/HBS/IT1112.txt", stringsAsFactors=FALSE)
View(IT1112)
ds3 <- read.csv("IT1112.txt", header = TRUE, sep = "\t", stringsAsFactors = FALSE, na.strings = c('', ' '))
IT1112 <- read.delim("~/GitHub/HBS/IT1112.txt", encoding="UTF-8")
View(IT1112)
ds3 <- read.csv("IT1112.txt", header = TRUE, sep = "\t", stringsAsFactors = FALSE, na.strings = c('', ' '))
View(ds3)
IT1112 <- read.delim("~/GitHub/HBS/IT1112.txt", encoding="UTF-8")
View(IT1112)
ds3 <- subset(IT1112, select = -c(url,kilde,undertitel,annonctekst,uklar))
ds3 <- subset(IT1112, select = -c(url,kilde,undertitel,annoncetekst,uklar))
save(ds3, file = IT1112.txt)
save(ds3, file = 'IT1112.txt')
ds3 <- read.csv("IT1112.txt", header = TRUE, sep = "\t", stringsAsFactors = FALSE, na.strings = c('', ' '))
ds3 <- read.delim("IT1112.txt", encoding = 'UTF-8')
ds3 <- read.delim("IT1112.txt", encoding = 'UTF-8')
ds3 <- read.delim("IT1112.txt", encoding = 'UTF-8')
ds3 <- read.delim("IT1112.txt", encoding = 'UTF-8')
ds4 <- read.delim("IT1314.txt", encoding = 'UTF-8')
ds4 <- read.delim("IT1314.txt", encoding = 'UTF-8')
ds1 <- read.delim("IT0808.txt", encoding = 'UTF-8')
ds2 <- read.delim("IT0910.txt", encoding = 'UTF-8')
ds3 <- read.delim("IT1112.txt", encoding = 'UTF-8')
ds4 <- read.delim("IT1314.txt", encoding = 'UTF-8')
ds <- rbind(ds1,ds2,ds3,ds4)
View(ds2)
ds <- subset(ds, select = -c(url,kilde,undertitel,annoncetekst,uklar))
save(ds, file='ds.csv')
save(ds, file='ds.csv',ascii = TRUE)
write.csv(ds,'ds.csv')
ds <- read.csv('ds.csv', encoding = 'ANSI')
ds <- read.csv2("~/GitHub/HBS/ds.csv", encoding="MS-ANSI", stringsAsFactors=FALSE)
View(ds)
ds <- read.csv2('ds.csv', encoding = 'MS-ANSI', stringsAsFactors = FALSE)
View(ds)
View(ds)
write.csv(ds,'ds.csv', row.names = FALSE)
ds1 <- NULL
ds2 <- NULL
ds3 <- NULL
ds4 <- NULL
remove(ds1)
remove(c(ds1,ds2,ds3,ds4)
)
remove(list = (ds1,ds2,ds3,ds4))
remove(list(ds1,ds2,ds3,ds4))
remove(ds2)
remove(ds3)
remove(ds4)
ds1 <- read.delim("IT0808.txt", encoding = 'UTF-8')
ds2 <- read.delim("IT0910.txt", encoding = 'UTF-8')
ds3 <- read.delim("IT1112.txt", encoding = 'UTF-8')
ds4 <- read.delim("IT1314.txt", encoding = 'UTF-8')
ds <- rbind(ds1,ds2,ds3,ds4)
#fjern variablerne kilde og uklar
ds <- subset(ds, select = -c(url,kilde,undertitel,annoncetekst,uklar))
#gem som csv
write.csv(ds,'ds.csv', row.names = FALSE)
remove(ds1,ds2,ds3,ds4)
ds <- read.csv2('ds.csv', encoding = 'MS-ANSI', stringsAsFactors = FALSE)
View(ds)
View(ds)
ds1 <- read.delim("IT0808.txt", encoding = 'UTF-8')
ds2 <- read.delim("IT0910.txt", encoding = 'UTF-8')
ds3 <- read.delim("IT1112.txt", encoding = 'UTF-8')
ds4 <- read.delim("IT1314.txt", encoding = 'UTF-8')
ds <- rbind(ds1,ds2,ds3,ds4)
#fjern variablerne kilde og uklar
ds <- subset(ds, select = -c(url,kilde,undertitel,annoncetekst,uklar))
#gem som csv
write.csv(ds,'ds.csv')
remove(ds1,ds2,ds3,ds4)
View(ds)
View(ds)
ds <- read.csv2('ds.csv', encoding = 'MS-ANSI', stringsAsFactors = FALSE, na.strings = c('' ,'NA'))
ds <- read.csv2('ds.csv', sep = "," ,encoding = 'MS-ANSI', stringsAsFactors = FALSE, na.strings = c('' ,'NA'))
View(ds)
View(ds)
View(ds)
View(ds)
ds <- filter(ds, nchar(postnummer) == 4 | is.na(postnummer))
description(ds)
str(ds)
description(ds)
summarize(ds)
summary(ds)
ds <- filter(ds, nchar(postnummer) == 4 | is.na(postnummer))
ds$dato <- as.Date(as.character(ds$dato),'%Y%m%d')
ds <- subset(ds, !(is.na(virksomhed)))
ds <- subset(ds, !(postnummer %in% c('0000','0001', '0100')))
ds$virksomhed <- tolower(ds$virksomhed)
nchar(postnummer)
ds <- filter(ds, nchar(ds.postnummer) == 4 | is.na(postnummer))
View(ds)
View(ds)
ds1 <- read.delim("IT0808.txt", encoding = 'UTF-8')
ds2 <- read.delim("IT0910.txt", encoding = 'UTF-8')
ds3 <- read.delim("IT1112.txt", encoding = 'UTF-8')
ds4 <- read.delim("IT1314.txt", encoding = 'UTF-8')
ds <- rbind(ds1,ds2,ds3,ds4)
#fjern variablerne kilde og uklar
ds <- subset(ds, select = -c(url,kilde,undertitel,annoncetekst,uklar))
#gem som csv
write.csv(ds,'ds.csv', row.names = FALSE)
ds <- read.csv2('ds.csv', header= TRUE, sep = "," ,encoding = 'MS-ANSI', stringsAsFactors = FALSE, na.strings = c('',' '))
View(ds)
View(ds)
ds <- filter(ds, nchar(postnummer) == 4 | is.na(postnummer))
ds <- filter(ds, nchar(ds$postnummer) == 4 | is.na(postnummer))
ds <- filter(ds, nchar(ds$postnummer) == 4 | is.na(ds$postnummer))
ds <- read.csv2('ds.csv', header= TRUE, sep = "," ,encoding = 'MS-ANSI', stringsAsFactors = FALSE, na.strings = c('',' '))
ds <- data.frame(ds)
ds <- filter(ds, nchar(postnummer) == 4 | is.na(postnummer))
ds <- filter(ds, nchar(ds$postnummer) == 4 | is.na(postnummer))
ds <- filter(ds, nchar(ds$postnummer) == 4 | is.na(ds$postnummer))
ds <- read.csv('ds.csv', header= TRUE, sep = "," ,encoding = 'MS-ANSI', stringsAsFactors = FALSE, na.strings = c('',' '))
ds <- filter(ds, nchar(postnummer) == 4 | is.na(postnummer))
library(tidyr)
install.packages("tidyr")
install.packages("dplyr")
ds <- filter(ds, nchar(postnummer) == 4 | is.na(postnummer))
library(tidyr)
library(dplyr)
ds <- filter(ds, nchar(postnummer) == 4 | is.na(postnummer))
ds$dato <- as.Date(as.character(ds$dato),'%Y%m%d')
ds <- subset(ds, !(is.na(virksomhed)))
ds <- subset(ds, !(postnummer %in% c('0000','0001', '0100')))
ds$virksomhed <- tolower(ds$virksomhed)
ds_cvr <- read.csv("39265897_93207_20160808134952_VIRKSOMHEDER.csv", header=TRUE, stringsAsFactors=FALSE)
ds_cvr$livsforloeb_startdato <- as.Date(ds_cvr$livsforloeb_startdato,'%d-%m-%Y')
ds_cvr <- filter(ds_cvr, as.numeric(format(livsforloeb_startdato,'%Y')) < 2009)
ds_cvr$navn_tekst <- tolower(ds_cvr$navn_tekst)
#fjern evt. leading og trailing whitespaces
ds$virksomhed <- trimws(ds$virksomhed, which = 'both')
ds_cvr$navn_tekst <- trimws(ds_cvr$navn_tekst, which = 'both')
ds_cvr <- read.csv("39265897_93207_20160808134952_VIRKSOMHEDER.csv", header=TRUE, stringsAsFactors=FALSE)
ds_cvr$livsforloeb_startdato <- as.Date(ds_cvr$livsforloeb_startdato,'%d-%m-%Y')
ds_cvr <- filter(ds_cvr, as.numeric(format(livsforloeb_startdato,'%Y')) < 2009)
ds_cvr$navn_tekst <- tolower(ds_cvr$navn_tekst)
#fjern evt. leading og trailing whitespaces
ds$virksomhed <- trimws(ds$virksomhed, which = 'both')
ds_cvr$navn_tekst <- trimws(ds_cvr$navn_tekst, which = 'both')
ds_match_cvr <- semi_join(ds,ds_cvr, by = c('virksomhed' = 'navn_tekst'))
ds_nomatch_cvr <- anti_join(ds,ds_cvr, by = c('virksomhed' = 'navn_tekst'))
View(ds_match_cvr)
View(ds_match_cvr)
View(ds_nomatch_cvr)
View(ds_nomatch_cvr)
remove(ds1,ds2,ds3,ds4)
source('~/GitHub/HBS/Exploratory.R', encoding = 'UTF-8')
View(ds)
View(ds)
View(ds)
source('~/GitHub/HBS/Exploratory2.R', encoding = 'UTF-8')
install.packages("stringdist")
source('~/GitHub/HBS/Exploratory2.R', encoding = 'UTF-8')
library(tidyr)
library(dplyr)
#library(stringi)
currentLocale <- Sys.getlocale("LC_CTYPE")
Sys.setlocale(locale = "en_DK.UTF-8")
# setwd("~/GIT/HBS")
ds <- read.csv('ds.csv', header= TRUE, sep = "," , fileEncoding = 'MS-ANSI', stringsAsFactors = FALSE, na.strings = c('',' '))
Sys.setlocale(locale = currentLocale)
#fjern alle hvor længden af postnummer er forskellig fra 4
#I de rækker der indeholder mere end et postnummer kan arbejdstedet ikke bestemmes entydigt.
#postnummer værdier som f. eks. københavn, skaane osv. kan ikke ikke bestemmes entydigt.
ds <- filter(ds, nchar(postnummer) == 4 | is.na(postnummer))
#formater dato variablen
ds$dato <- as.Date(as.character(ds$dato),'%Y%m%d')
#fjern alle hvor virksomhed ikke er angivet
ds <- subset(ds, !(is.na(virksomhed)))
#fjern alle rækker hvor postnummer indikerer udlandet
#og sæt virksomhed til lower case
ds <- subset(ds, !(postnummer %in% c('0000','0001', '0100')))
ds$virksomhed <- tolower(ds$virksomhed)
#externt ds som benyttes til at finde eksakt adresse og postnummer/kommune
#tag kun firmaer der er registreret før 31-dec-2008
#og sæt navn_tekst til lower case
ds_cvr <- read.csv("39265897_93207_20160808134952_VIRKSOMHEDER.csv", header=TRUE, stringsAsFactors=FALSE)
ds_cvr$livsforloeb_startdato <- as.Date(ds_cvr$livsforloeb_startdato,'%d-%m-%Y')
ds_cvr2 <- filter(ds_cvr, format(ds_cvr$livsforloeb_startdato,'%Y') < '2009')
ds_cvr$navn_tekst <- tolower(ds_cvr$navn_tekst)
ds_cvr <- subset(ds_cvr2, select = c(cvrnr, navn_tekst, beliggenhedsadresse_vejnavn, beliggenhedsadresse_husnummerFra, beliggenhedsadresse_bogstavFra, beliggenhedsadresse_postnr, beliggenhedsadresse_postdistrikt, beliggenhedsadresse_bynavn, beliggenhedsadresse_kommune_tekst))
ds$virksomhed <- trimws(ds$virksomhed, which = 'both')
ds_cvr$navn_tekst <- trimws(ds_cvr$navn_tekst, which = 'both')
write.csv(ds_cvr,'ds_cvr.csv', row.names = FALSE)
ds_cvr <- subset(ds_cvr, !(is.na(livsforloeb_startdato)))
View(ds_cvr2)
ds_cvr2 <- subset(ds_cvr2, !(is.na(livsforloeb_startdato)))
source('~/GIT/HBS/Exploratory.R')
View(ds_cvr)
ds_cvr <- read.csv("ds_cvr.csv", header=TRUE, sep = "," , fileEncoding = 'MS-ANSI', stringsAsFactors=FALSE, na.strings = c('',' '))
ds_cvr <- read.csv("~/GIT/HBS/ds_cvr.csv", stringsAsFactors=FALSE)
View(ds_cvr)
ds_cvr <- read.csv("ds_cvr.csv", header=TRUE, stringsAsFactors=FALSE)
View(ds_cvr)
source('~/GIT/HBS/Exploratory.R')
dist.name<-adist(ds_nomatch_cvr$virksomhed,ds_cvr$navn_tekst ,partial = TRUE, ignore.case = TRUE, useBytes = TRUE)
dist.name<-adist(ds_nomatch_cvr$virksomhed[1],ds_cvr$navn_tekst ,partial = TRUE, ignore.case = TRUE, useBytes = TRUE)
min.name<-apply(dist.name, 1, min)
match.s1.s2<-NULL
for(i in 1:nrow(dist.name))
{
s2.i<-match(min.name[i],dist.name[i,])
s1.i<-i
match.s1.s2<-rbind(data.frame(s2.i=s2.i,s1.i=s1.i,NOMATCH=ds_nomatch_cvr[s1.i,]$virksomhed,CVR=ds_cvr[s2.i,]$navn_tekst, adist=min.name[i]),match.s1.s2)
}
View(match.s1.s2)
source('~/GIT/HBS/Exploratory2.R')
View(ds_match_cvr)
install.packages("swirl")
library(swirl)
install.packages("RCurl")
install.packages("openssl")
library(swirl)
install.packages("swirl")
install.packages("swirl")
install.packages("codetools")
install.packages("swirl")
install.packages("openssl")
install.packages("swirl")
install.packages("swirl")
library(swirl)
install_from_swirl("regression models")
install_from_swirl("Regression Models")
swirl()
